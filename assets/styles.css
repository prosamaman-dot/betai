/*
	Black & White Advanced Chat UI
	Only grayscale. No external frameworks. Inter font for elegance.
*/

:root {
	--bg: #0a0a0a;
	--panel: #0f0f0f;
	--elev: #141414;
	--muted: #888;
	--muted-2: #666;
	--fg: #fff;
	--edge: #1a1a1a;
	--line: #222;
	--glass: rgba(255,255,255,0.03);
	--glass-2: rgba(255,255,255,0.06);
	--shadow: 0 10px 30px rgba(0,0,0,0.5);
	--radius: 16px;
	--radius-sm: 10px;
	--radius-xs: 8px;
	--speed: 180ms;
}

* { box-sizing: border-box; }
html, body { height: 100%; }
body {
	margin: 0;
	font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
	background: radial-gradient(circle at 20% 0%, #0d0d0d 0%, #090909 40%, #050505 100%);
	color: var(--fg);
	letter-spacing: 0.1px;
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
}

.sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }

.app {
	display: grid;
	grid-template-columns: 320px 1fr;
	grid-template-rows: 100vh;
	gap: 0;
}

/* Sidebar */
.sidebar {
	border-right: 1px solid var(--edge);
	background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.0));
	padding: 18px 16px 12px 16px;
	position: relative;
}
.sidebar__header {
	display: flex; align-items: center; justify-content: space-between;
	padding: 8px 6px 14px 6px;
	position: sticky; top: 0; background: linear-gradient(180deg, rgba(10,10,10,0.9), rgba(10,10,10,0.6)); backdrop-filter: blur(6px);
	z-index: 2;
}
.mobile-close-btn { display: none; }
.logo { position: relative; display: inline-flex; align-items: center; gap: 10px; cursor: default; }
.logo__core { width: 14px; height: 14px; border-radius: 50%; background: var(--fg); box-shadow: 0 0 20px rgba(255,255,255,0.2) inset; }
.logo__orbit { position: absolute; width: 28px; height: 28px; border-radius: 50%; border: 1px dashed rgba(255,255,255,0.25); left: -7px; top: -7px; animation: orbit 10s linear infinite; opacity: 0.7; }
@keyframes orbit { to { transform: rotate(360deg); } }
.logo__text { font-weight: 800; letter-spacing: 0.5px; }

.icon-btn { width: 36px; height: 36px; border-radius: 50%; border: 1px solid var(--edge); background: var(--glass); color: var(--fg); display: inline-grid; place-items: center; cursor: pointer; transition: background var(--speed), transform var(--speed); }
.icon-btn:hover { background: var(--glass-2); transform: translateY(-1px); }
.i { width: 18px; height: 18px; display: inline-block; }
.i--plane { width: 16px; height: 16px; }

.sidebar__section { margin-top: 14px; padding: 8px; border-top: 1px dashed var(--edge); }
.new-chat-btn { width: 100%; height: 40px; padding: 0 14px; border: 1px solid var(--edge); background: var(--glass); color: var(--fg); border-radius: var(--radius-xs); cursor: pointer; transition: background var(--speed), transform var(--speed); display: flex; align-items: center; justify-content: center; font-weight: 600; }
.new-chat-btn:hover { background: #121212; transform: translateY(-1px); }
.sidebar__section--history { position: absolute; bottom: 0; left: 0; right: 0; padding: 12px 16px 16px 16px; background: linear-gradient(0deg, rgba(10,10,10,0.95), rgba(10,10,10,0)); }
.section__title { font-size: 12px; text-transform: uppercase; letter-spacing: 1.2px; color: var(--muted); margin: 2px 0 10px; }

.template-list, .history-list { list-style: none; padding: 0; margin: 0; display: grid; gap: 8px; }
.template-list li, .history-list li { border: 1px solid var(--edge); background: var(--panel); border-radius: var(--radius-xs); padding: 10px 12px; cursor: pointer; transition: transform var(--speed), background var(--speed); }
.template-list li:hover, .history-list li:hover { background: #121212; transform: translateY(-1px); }
.history-list li { display: flex; align-items: center; justify-content: space-between; gap: 8px; }
.history-list li span { color: var(--muted); font-size: 12px; }

/* Main Panel */
.panel { display: grid; grid-template-rows: auto 1fr auto; height: 100vh; }
.panel__header { display: flex; align-items: center; justify-content: space-between; padding: 18px 24px; border-bottom: 1px solid var(--edge); background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0)); position: sticky; top: 0; z-index: 2; backdrop-filter: blur(6px); }
.title { display: flex; align-items: center; gap: 14px; }
.mobile-history-btn { display: none; width: 36px; height: 36px; border-radius: 50%; border: 1px solid var(--edge); background: var(--glass); color: var(--fg); cursor: pointer; transition: all var(--speed); place-items: center; position: relative; }
.mobile-history-btn:hover { background: var(--glass-2); transform: translateY(-1px); box-shadow: 0 4px 12px rgba(255,255,255,0.1); }
.mobile-history-btn:active { transform: scale(0.95); }
.mobile-history-btn .i { width: 20px; height: 20px; transition: transform var(--speed); }
.mobile-history-btn:hover .i { transform: rotate(15deg); }
.title__line { width: 26px; height: 2px; background: var(--fg); display: inline-block; box-shadow: 12px 0 0 0 #fff inset; }
.panel__header h1 { font-size: 16px; font-weight: 700; margin: 0; }

.toolbar { display: flex; gap: 8px; }
.ghost-btn { height: 36px; padding: 0 12px; border-radius: 999px; border: 1px solid var(--edge); background: var(--glass); color: var(--fg); cursor: pointer; transition: background var(--speed), transform var(--speed); display: inline-grid; place-items: center; }
.ghost-btn:hover { background: var(--glass-2); transform: translateY(-1px); }
.ghost-btn.listening { background: var(--glass-2); box-shadow: 0 0 0 2px rgba(255,255,255,0.05) inset, 0 0 0 0 rgba(255,255,255,0.25); animation: pulse 1.4s ease-in-out infinite; }
.ghost-btn.listening .i { transform-origin: center; animation: mic-breathe 1.4s ease-in-out infinite; }

.messages { padding: 24px; overflow: auto; display: grid; gap: 16px; align-content: start; }
.message { display: flex; width: 100%; }
.message--assistant { justify-content: flex-start; }
.message--user { justify-content: flex-end; }
.bubble { border: 1px solid var(--edge); background: var(--panel); border-radius: var(--radius); padding: 14px 16px; box-shadow: var(--shadow); position: relative; max-width: 75%; }
.bubble--user { background: #0d0d0d; }
.bubble__toolbar { position: absolute; top: -14px; display: flex; gap: 6px; opacity: 0; transition: opacity var(--speed); }
.message--assistant .bubble__toolbar { right: 8px; }
.message--user .bubble__toolbar { left: 8px; }
.message:hover .bubble__toolbar { opacity: 1; }
.bubble__btn { height: 28px; width: 34px; padding: 0; border: 1px solid var(--edge); background: var(--glass); color: var(--fg); border-radius: 999px; cursor: pointer; display: grid; place-items: center; }
.bubble__btn:hover { background: var(--glass-2); }

/* Icon animations */
.icon-btn:hover .i use[href="#icon-gear"], .icon-btn:hover .i use[xlink\:href="#icon-gear"] { animation: spin 1s linear; }
.bubble__btn[data-act="regen"] .i { transition: transform var(--speed); }
.bubble__btn[data-act="regen"]:hover .i { transform: rotate(120deg); }
.send-btn:hover .i--plane { transform: translateX(1px) translateY(-1px); transition: transform var(--speed); }
@keyframes spin { to { transform: rotate(360deg); } }

.composer { border-top: 1px solid var(--edge); background: linear-gradient(0deg, rgba(255,255,255,0.02), rgba(255,255,255,0)); position: sticky; bottom: 0; padding: 16px 24px; }
.composer__wrap { border: 1px solid var(--edge); background: #0e0e0e; border-radius: var(--radius); padding: 10px; display: grid; grid-template-columns: 1fr auto; gap: 10px; box-shadow: var(--shadow); }
.input { background: transparent; color: var(--fg); border: 0; outline: none; resize: none; font-size: 14px; line-height: 1.6; padding: 8px 10px; max-height: 220px; overflow: auto; }
.composer__actions { display: flex; align-items: center; gap: 8px; }
.send-btn { height: 36px; width: 48px; padding: 0; border-radius: 999px; background: #fff; color: #000; border: 1px solid #fff; cursor: pointer; transition: transform var(--speed), box-shadow var(--speed); box-shadow: 0 8px 24px rgba(255,255,255,0.1); display: inline-grid; place-items: center; }
.send-btn:hover { transform: translateY(-1px); box-shadow: 0 12px 28px rgba(255,255,255,0.15); }
.hints { margin-top: 10px; color: var(--muted); font-size: 12px; display: flex; justify-content: center; }

/* Modal */
.modal { position: fixed; inset: 0; display: none; }
.modal[aria-hidden="false"] { display: block; }
.modal__backdrop { position: absolute; inset: 0; background: rgba(0,0,0,0.6); backdrop-filter: blur(4px); }
.modal__dialog { position: relative; margin: 8vh auto 0; width: min(560px, 92vw); background: #0f0f0f; border: 1px solid var(--edge); border-radius: var(--radius); box-shadow: var(--shadow); overflow: hidden; }
.modal__header { display: flex; align-items: center; justify-content: space-between; padding: 14px 16px; border-bottom: 1px solid var(--edge); }
.modal__body { padding: 16px; display: grid; gap: 12px; }
.modal__footer { padding: 16px; border-top: 1px solid var(--edge); display: flex; justify-content: flex-end; }
.field { display: grid; gap: 6px; }
.field__label { font-size: 12px; text-transform: uppercase; color: var(--muted); letter-spacing: 1px; }
.field input { height: 40px; padding: 0 12px; border-radius: var(--radius-xs); border: 1px solid var(--edge); background: #0a0a0a; color: var(--fg); }
.field select { height: 40px; padding: 0 12px; border-radius: var(--radius-xs); border: 1px solid var(--edge); background: #0a0a0a; color: var(--fg); }
.field input[type="checkbox"] { height: 18px; width: 18px; accent-color: #fff; }
.muted { color: var(--muted); font-size: 13px; }

/* Palette */
.palette { position: fixed; inset: 0; display: none; }
.palette[aria-hidden="false"] { display: block; }
.palette__backdrop { position: absolute; inset: 0; background: rgba(0,0,0,0.5); backdrop-filter: blur(3px); }
.palette__dialog { position: relative; margin: 12vh auto 0; width: min(720px, 94vw); border: 1px solid var(--edge); border-radius: var(--radius); background: #0e0e0e; box-shadow: var(--shadow); overflow: hidden; }
.palette__input { width: 100%; height: 54px; padding: 0 16px; border: 0; outline: none; background: #0a0a0a; color: var(--fg); border-bottom: 1px solid var(--edge); font-size: 14px; }
.palette__list { list-style: none; margin: 0; padding: 8px; max-height: 50vh; overflow: auto; display: grid; gap: 8px; }
.palette__list li { border: 1px solid var(--edge); background: var(--panel); padding: 10px 12px; border-radius: var(--radius-xs); cursor: pointer; }
.palette__list li:hover { background: #121212; }

/* Advanced Markdown styling */
.bubble .content { line-height: 1.7; position: relative; word-wrap: break-word; overflow-wrap: break-word; word-break: break-word; }
.thinking { display: flex; align-items: center; gap: 6px; padding: 8px 0; min-height: 24px; overflow: visible; }
.thinking__dot { 
	width: 8px; 
	height: 8px; 
	border-radius: 50%; 
	background: var(--muted); 
	animation: thinking-pulse 1.4s cubic-bezier(0.4, 0, 0.6, 1) infinite; 
	transform-origin: center;
}
.thinking__dot:nth-child(1) { animation-delay: 0s; }
.thinking__dot:nth-child(2) { animation-delay: 0.2s; }
.thinking__dot:nth-child(3) { animation-delay: 0.4s; }
@keyframes thinking-pulse {
	0%, 100% { 
		opacity: 0.3; 
		transform: translateY(0) scale(0.9); 
	}
	50% { 
		opacity: 1; 
		transform: translateY(-4px) scale(1.1); 
	}
}
.bubble h1, .bubble h2, .bubble h3 { margin: 16px 0 10px 0; font-weight: 700; }
.bubble h1 { font-size: 1.5em; }
.bubble h2 { font-size: 1.3em; }
.bubble h3 { font-size: 1.1em; }
.bubble p { margin: 10px 0; color: #eaeaea; }
.bubble strong { font-weight: 700; color: #fff; }
.bubble em { font-style: italic; color: #d0d0d0; }
.bubble code { background: #0a0a0a; border: 1px solid var(--edge); padding: 3px 8px; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 0.9em; color: #fff; }
.bubble pre { background: #0a0a0a; border: 1px solid var(--edge); padding: 14px; border-radius: 10px; overflow: auto; margin: 12px 0; }
.bubble pre code { background: transparent; border: 0; padding: 0; }
.bubble ul, .bubble ol { margin: 12px 0; padding-left: 24px; }
.bubble li { margin: 8px 0; color: #eaeaea; }
.bubble a { color: #fff; text-decoration: underline; text-decoration-color: rgba(255,255,255,0.4); transition: text-decoration-color 0.2s; }
.bubble a:hover { text-decoration-color: rgba(255,255,255,0.8); }
.bubble .sources-container { margin-top: 12px; padding-top: 12px; border-top: 1px solid var(--edge); }
.sources-btn { display: inline-flex; align-items: center; gap: 6px; padding: 8px 14px; border: 1px solid var(--edge); background: var(--glass); color: var(--fg); border-radius: var(--radius-xs); cursor: pointer; transition: all var(--speed); font-size: 13px; font-weight: 500; }
.sources-btn:hover { background: var(--glass-2); transform: translateY(-1px); }
.sources-btn .i { width: 16px; height: 16px; }
.source-item { display: flex; gap: 12px; padding: 12px; border: 1px solid var(--edge); border-radius: var(--radius-xs); margin-bottom: 10px; background: var(--panel); }
.source-item__number { width: 24px; height: 24px; border-radius: 50%; background: var(--glass); border: 1px solid var(--edge); display: grid; place-items: center; font-size: 12px; font-weight: 600; flex-shrink: 0; }
.source-item__content { flex: 1; min-width: 0; }
.source-item__title { font-weight: 600; margin-bottom: 6px; color: var(--fg); word-wrap: break-word; }
.source-item__link { font-size: 12px; color: var(--muted); text-decoration: none; word-break: break-all; display: block; }
.source-item__link:hover { color: var(--fg); text-decoration: underline; }
.bubble blockquote { border-left: 3px solid var(--muted); padding-left: 14px; margin: 12px 0; color: var(--muted); font-style: italic; }

/* Responsive */
@media (max-width: 980px) {
	.app { grid-template-columns: 1fr; }
	.sidebar { 
		position: fixed; 
		left: -100%; 
		top: 0; 
		height: 100vh; 
		width: 320px; 
		z-index: 1000; 
		transition: left 0.3s ease;
		background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.0));
		box-shadow: 2px 0 20px rgba(0,0,0,0.5);
	}
	.sidebar--open { left: 0; }
	.mobile-history-btn { display: grid; }
	.mobile-close-btn { display: grid !important; }
	body.sidebar-open::before {
		content: '';
		position: fixed;
		inset: 0;
		background: rgba(0,0,0,0.5);
		backdrop-filter: blur(4px);
		z-index: 999;
		pointer-events: all;
	}
}
@media (max-width: 768px) {
	.messages { padding: 16px; }
	.bubble { max-width: 90%; }
}
@media (max-width: 480px) {
	.messages { padding: 12px; }
	.bubble { max-width: 95%; padding: 12px 14px; }
}

@keyframes pulse { 0%, 100% { box-shadow: 0 0 0 0 rgba(255,255,255,0.18); } 50% { box-shadow: 0 0 0 6px rgba(255,255,255,0.0); } }
@keyframes mic-breathe { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.06); opacity: 0.9; } }


